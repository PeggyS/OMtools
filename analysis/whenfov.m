% whenfov.m:  find when the position falls just inside the % foveation radius of 0.5 deg/sec.% written by: Jonathan Jacobs%             December 1995 - January 1997  (last mod: 01/24/97)[nRows, nCols] = size(sacv_on_mat);% initialize crossing arrayssampl_cross = NaN*ones(nRows, nCols);time_cross  = NaN*ones(nRows, nCols);avg_cross   = [];med_cross   = [];big_hist    = [];cutoff_time = input('Go back up to how many milliseconds? ');%cutoff_samp = cutoff_time*samp_freq/1000;  % cutoff_time ms before saccade% process each selected file's sacv_on_matfor k=1:nCols   cutoff_samp = cutoff_time*samp_f_mat(k)/1000;  % ms before saccade   list_len(k) = length(find(sacv_on_mat(:,k)<100000));   sacv_on = sacv_on_mat( 1:list_len(k), k );  % strip NaNs   % do each point in the vel-derived saccade-on list   for j=1:list_len(k)       offset(j) = 0;       while abs(pos( sacv_on(j) - offset(j), k )) > 0.5          offset(j) = offset(j) + 1;          if ( offset(j) > cutoff_samp )  % didn't get inside slip rad             offset(j) = NaN;             % so NaN out this point             disp(['Didn''t fit in radius by ' num2str(cutoff_time)...                   ' msec: saccade ' num2str(j) ' in record ' num2str(k)...                   ' (' deblank(what_f_array(k,:)) ')'])             break;          end       end       % collect stats       sampl_cross(j,k) = sacv_on(j)-offset(j);       time_cross(j,k) = 1000 * offset(j)/samp_f_mat(k);   end    good_pts = find(time_cross(:,k) < 100000);   % strip out the NaNs   if good_pts ~= []      avg_cross(k)    = mean( time_cross(good_pts, k) );      avg_cross_total = mean(avg_cross);      med_cross(k)    = median( time_cross(good_pts, k) );      med_cross_total = mean(med_cross);      big_hist        = [big_hist' time_cross(good_pts, k)']';   endenddisp( ['Average crossing time: ' num2str(avg_cross_total)] )disp( ['Median crossing time: '  num2str(med_cross_total)] )[f_numb, f_bins] = hist(big_hist, 100);bar(f_bins, f_numb)orient landscape%hist(big_hist,100);title(['Average time at crossing -- ' num2str(avg_cross_total) 'msec'])xlabel('Time of crossing foveal radius (msec before saccade)')ylabel('Number of occurrences')orient landscapeif ~exist('export') export = 0; endif export   expdir   f_numb = f_numb';   save f_numb.txt f_numb /ascii   f_bins = f_bins';   save f_bins.txt f_bins /asciiendif ~exist('debugme') debugme = 0; endif ~debugme   clear nRows nCols   clear k j list_len sacv_on offset good_pts   clear big_hist f_numb f_bins   clear avg_cross_total avg_cross time_cross   clear sampl_cross med_cross med_cross_totalend